<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta http-equiv="x-ua-compatible" content="ie-edge">
    <title>CULTISENSE | Sondas</title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
    <link rel="stylesheet" href="css/botones.css">
    <link rel="stylesheet" href="css/footer.css">

    <!--
        Librería de gráficos
                            -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/moment.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.20.1/locale/es.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.7.1/Chart.min.js"></script>
    <!--<script src="js/grafica.js"></script>-->
</head>

<style>
    #C {
        width: 80%;
        height: auto;
    }

    body {
        font-family: Montserrat;
    }

    .navbar {
        padding: 0;
    }

    .titulo {
        color: #55c5ff;
        font-family: Montserrat-Bold;
        margin-bottom: 0;
        display: none;
    }

    header nav a {
        max-width: inherit;
    }

    .container {
        max-width: 40%;
    }

    @media (max-width: 767.98px) {
        .container {
            max-width: 90%;
        }

        footer span {
            font-size: 0.6rem;
        }
    }

    body {
        font-family: Montserrat;
    }

    .container {
        max-width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0;
    }

    .divSensores,
    .divZonas {

        margin: 0.5rem;
        border: 1px solid #eee;
        border-radius: 10px;
        display: flex;
        flex-direction: column;
        align-items: center;
        max-width: 100%;
    }

    #bootstrap-overwrite .dropdown-menu {
        min-width: 0px;
    }

    .sens1,
    .sens2,
    .sens3,
    .zona1,
    .zona2,
    .zona3 {
        margin: 0 0.5rem 0 0.5rem;
    }

    .botonEnviar {
        margin: 0.5rem auto;
    }

    .canvas {
        display: block;
    }

    @media (max-width: 767.98px) {
        .container {
            max-width: 90%;
        }

        .titulo {
            display: block;
        }

        .navbar-collapse {
            background-color: #55c5ff;
            padding: 0.5rem 1rem;
        }

        footer span {
            font-size: 0.6rem;
        }
    }

    .botones {

        display: flex;
        flex-direction: row;
        align-self: center;
        /*align-items: stretch;*/
        align-content: stretch;
    }

    .botones a {
        margin: 0.3rem;
    }

    #mapa {
        width: inherit;
        height: 400px;
        border: solid 1px #ccc;
    }

    #graph {
        margin: 0;
    }

</style>

<body id="bootstrap-overwrite">

    <header class="encabezado">
        <nav class="navbar navbar-dark navbar-expand-md bg-dark">
            <a class="navbar-brand" href="#" style="width: 50px; margin: 0.5rem 1rem;"><img id="C" src="images/logo_C.svg"></a>
            <a href="#">
                <h4 class="titulo">Home</h4>
            </a>

            <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#navbarsExample01" aria-controls="navbarsExample01" aria-expanded="false" aria-label="Toggle navigation" style="margin: 0.5rem 1rem;">
            <span class="navbar-toggler-icon"></span>
        </button>

            <div class="navbar-collapse collapse" id="navbarsExample01">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active">
                        <a class="nav-link itemsMenu" href="#">Home<span class="sr-only">(current)</span></a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Alertas</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#">Soporte Técnico</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mis-datos.html">Perfil</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="mis-datos.html">Cerrar sesión</a>
                    </li>
                </ul>

            </div>
        </nav>

    </header>

    <div class="container">

        <!-- ZONAS -->

        <p>Paso 1: Elige la zona que quiere ver.</p>
        <div class="divZonas">
            <div class="dropdown">
                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
            Zonas
            </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                    <div id="zonas-list">
                    </div>
                </div>
            </div>
        </div>

        <!-- MAPA -->
        <div id="mapa"></div>
        <div class="botones">
            <a class="btn btn-outline-primary" role="button" onclick="editarZona()">Editar</a>
            <a class="btn btn-outline-primary" role="button" onclick="guardarZona()">Guardar</a>
        </div>

        <!-- SONDAS -->
        <div class="divSensores col-sm-5" id="sensoresCheck">
            <p>Paso 2: Elige las sondas que quiere ver.</p>
            <div class="checkSondas" id="sensores-list">
                <!--<div class="custom-control custom-checkbox sens1">
                            <input type="checkbox" class="custom-control-input" id="customCheck1">
                            <label class="custom-control-label" for="customCheck1">Sonda 1</label>
                        </div>
                        <div class="custom-control custom-checkbox sens2">
                            <input type="checkbox" class="custom-control-input" id="customCheck2">
                            <label class="custom-control-label" for="customCheck2">Sonda 2</label></div>
                        <div class="custom-control custom-checkbox sens3">
                            <input type="checkbox" class="custom-control-input" id="customCheck3">
                            <label class="custom-control-label" for="customCheck3">Sonda 3</label></div>-->
            </div>
        </div>

        <!-- GRAFICA -->
        <div id="graph" class="container">
            <canvas id="grafica" width="500" height="400" class="chartjs-render-monitor"></canvas>
        </div>

    </div>

    <script>
        var mapa;

        var zona;


        function initMap() {             // pasamos como primer parámetro el mapa (con el id)
            // y como segundo parámetro las opciones del mapa en forma de objeto:
            // zoom es el valor de zoom del mapa
            // center es un objeto con los valores de latitud y longitud donde tiene q tener el centro al cargarlo
            // streetViewControl false para quitar el muñequito de street view

            mapa = new google.maps.Map(document.getElementById('mapa'), {
                zoom: 16,
                center: {
                    lat: 38.9922807,
                    lng: -0.1735785
                },
                streetViewControl: false
            });

            // especificar el tipo de mapa (tmb se podria especificar en las opciones en mapa = ....)

            mapa.setMapTypeId('satellite');
        }


        function editarZona() {             // pasa de editable a no editable y viceversa
            zona.poligono.setEditable(!zona.poligono.getEditable());
        }

        // FALLA

        function guardarZona() {
            var datosParaEnviar = {};
            datosParaEnviar.color = zona.color;
            datosParaEnviar.id = zona.id;
            datosParaEnviar.nombre = zona.nombre;
            datosParaEnviar.vertices = zona.poligono.getPath().toArray();

            console.log(datosParaEnviar)
        }

    </script>


    <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAb24jHOG5TNONnZFGrHXCfnkoEnhfpKxc&callback=initMap&libraries=visualization">


    </script>

    <!-- FINAL MAPA -->

    <button type="button" class="btn btn-primary botonEnviar" onclick="visualizarGrafica()" id="boton-siguiente" hidden>
    Siguiente
</button>
    <footer class="footer" role="contentinfo">
        <span>Copyright © 2018 Cultisense <br>Todos los derechos reservados | Términos de uso</span>


        <div>
            <img src="images/logo_facebook.svg" alt="logoFacebook">
            <img src="images/logo_twitter.svg" alt="logoTwitter">
        </div>

    </footer>

    <script src="https://code.jquery.com/jquery-3.2.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>
    <script src="js/sensor.js"></script>
    <script src="js/zona.js"></script>
    <!-- Localization start-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.4/jquery.i18n.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.4/jquery.i18n.messagestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.i18n/1.0.4/jquery.i18n.parser.js"></script>
    <script src="js/localize.js" type="text/javascript"></script>
    <!-- Localization end-->


</body>
